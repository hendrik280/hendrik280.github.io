<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reactietijd Test</title>
<link rel="icon" href="images/reddot.ico" type="image/x-icon">

<style>
  body {
    display: flex;
    flex-direction: column;
    align-items: center;
    font-family: 'Arial', sans-serif;
    padding: 5px;
    background: linear-gradient(to bottom right, #e8f5e9, #ffffff);
  }

  /* Top title styling with extra spacing from top */
  h1 {
    font-size: 32px;
    color: #2e7d32;
    margin-top: 1px; /* ‚Üê Added spacing from top */
    margin-bottom: 5px;
  }

  /* Card-style controls box */
  #controls {
    margin-bottom: 20px;
    text-align: center;
    border: 2px solid #4CAF50;
    padding: 10px;
    border-radius: 12px;
    background-color: #ffffff;
    box-shadow: 0 3px 10px rgba(0,0,0,0.1);
  }

  #message {
    font-size: 22px;
    margin-bottom: 8px;
    padding: 10px 15px;
    background-color: #4CAF50;
    color: white;
    border-radius: 10px;
    text-align: center;
    width: 400px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.1);
  }

  #testWrapper {
    position: relative;
    width: 1000px;
    height: 450px;
  }

  #dotArea {
    position: absolute;
    width: 100%;
    height: 100%;
    border: 5px solid #4CAF50;
    border-radius: 12px;
    background-color: #fbfbfb;
    cursor: crosshair;
    box-shadow: inset 0 2px 8px rgba(0,0,0,0.1);
  }

  #dot {
    width: 50px;
    height: 50px;
    background-color: red;
    border-radius: 50%;
    position: absolute;
    display: none;
    cursor: pointer;
    box-shadow: 0 0 10px rgba(255,0,0,0.5);
  }

  /* Fade-in animation */
  @keyframes fadeIn {
    from { opacity: 0; transform: translate(-50%, -45%); }
    to   { opacity: 1; transform: translate(-50%, -50%); }
  }

  /* Results popup */
  #results {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 999;
    background-color: white;
    padding: 25px;
    width: 380px;
    border: 3px solid #4CAF50;
    border-radius: 12px;
    text-align: center;
    display: none;
    box-shadow: 0 5px 25px rgba(0, 0, 0, 0.3);
    animation: fadeIn 0.4s ease-out;
  }

  table {
    border-collapse: collapse;
    margin: 15px auto;
    width: 90%;
  }

  th, td {
    border: 1px solid #333;
    padding: 8px 12px;
  }

  /* Buttons */
  button {
    padding: 12px 22px;
    font-size: 16px;
    cursor: pointer;
    border-radius: 8px;
    border: none;
    background-color: #4CAF50;
    color: white;
    transition: 0.2s;
  }

  button:hover {
    background-color: #43a047;
    box-shadow: 0 3px 10px rgba(0,0,0,0.2);
  }

  #closeResults {
    margin-top: 12px;
    width: 45%;
  }

  #restartTest {
    margin-top: 12px;
    width: 45%;
    background-color: #1e88e5;
  }

  #restartTest:hover {
    background-color: #1976d2;
  }

  label {
    font-size: 18px;
  }

  input[type="range"] {
    width: 300px;
  }

</style>
</head>
<body>

<h1>Reactietijd Test</h1>

<div id="controls">
  <label for="numTrials">Aantal pogingen: <span id="numDisplay">5</span></label><br>
  <input type="range" id="numTrials" min="1" max="10" value="5"><br><br>
  <button id="startBtn">Start test</button>
</div>

<div id="message">Klik zo snel mogelijk op de rode stip!</div>

<div id="testWrapper">
  
  <div id="dotArea">
    <div id="dot"></div>
  </div>

  <div id="results"></div>

</div>

<script>
let reactionTimes = [];
let trials = 0;
let maxTrials = 5;
let startTime;
let misclicks = 0;

const dot = document.getElementById('dot');
const message = document.getElementById('message');
const resultsDiv = document.getElementById('results');
const dotArea = document.getElementById('dotArea');
const numTrialsSlider = document.getElementById('numTrials');
const numDisplay = document.getElementById('numDisplay');
const startBtn = document.getElementById('startBtn');

/* Update slider text */
numTrialsSlider.addEventListener('input', () => {
  numDisplay.innerText = numTrialsSlider.value;
});

/* Show the red dot */
function showDot() {
    const areaWidth = dotArea.clientWidth - 50;
    const areaHeight = dotArea.clientHeight - 50;
    const x = Math.random() * areaWidth;
    const y = Math.random() * areaHeight;

    dot.style.left = x + 'px';
    dot.style.top = y + 'px';
    dot.style.display = 'block';

    startTime = Date.now();
}

/* Proceed to next trial */
function nextTrial() {
    if (trials < maxTrials) {
        setTimeout(showDot, Math.random() * 1000 + 500);
    } else {
        displayResults();
    }
}

/* Show results */
function displayResults() {
    dot.style.display = 'none';
    message.innerText = 'Test voltooid! Hier zijn je resultaten:';

    const fastest = Math.min(...reactionTimes);
    const slowest = Math.max(...reactionTimes);
    const avg = Math.round(reactionTimes.reduce((a, b) => a + b, 0) / reactionTimes.length);

    let tableHTML = '<table><tr><th>Poging</th><th>Reactietijd (ms)</th></tr>';
    reactionTimes.forEach((time, index) => {
        let color = '';
        if (time === fastest) color = ' style="color:green;font-weight:bold"';
        if (time === slowest) color = ' style="color:red;font-weight:bold"';

        tableHTML += `<tr><td>${index + 1}</td><td${color}>${time}</td></tr>`;
    });

    tableHTML += `<tr><th>Gemiddeld</th><th>${avg}</th></tr></table>`;
    tableHTML += `<p>Misclicks: ${misclicks}</p>`;
    tableHTML += `
        <button id="restartTest">Opnieuw starten</button>
        <button id="closeResults">Sluiten</button>
    `;

    resultsDiv.innerHTML = tableHTML;
    resultsDiv.style.display = 'block';

    // Close button
    document.getElementById('closeResults').onclick = () => {
        resultsDiv.style.display = 'none';
    };

    // Restart button
    document.getElementById('restartTest').onclick = () => {
        resultsDiv.style.display = 'none';
        startTest();
    };
}

/* Dot click */
dot.addEventListener('click', (e) => {
    e.stopPropagation();
    const reactionTime = Date.now() - startTime;

    reactionTimes.push(reactionTime);
    trials++;
    dot.style.display = 'none';

    message.innerText = `Reactietijd: ${reactionTime} ms`;

    nextTrial();
});

/* Misclick count */
dotArea.addEventListener('click', () => {
    if (dot.style.display === 'block') misclicks++;
});

/* Start test logic */
startBtn.addEventListener('click', startTest);

function startTest() {
    maxTrials = parseInt(numTrialsSlider.value);
    reactionTimes = [];
    trials = 0;
    misclicks = 0;

    resultsDiv.style.display = 'none';
    resultsDiv.innerHTML = '';
    message.innerText = 'Maak je klaar...';

    nextTrial();
}
</script>

</body>
</html>
